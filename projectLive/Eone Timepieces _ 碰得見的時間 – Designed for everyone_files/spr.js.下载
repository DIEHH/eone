window.innerShiv=function(){function t(t,e,i){return/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i.test(i)?t:e+"></"+i+">"}var e,i,n=document,a="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" ");return function(r,o){if(!e&&(e=n.createElement("div"),e.innerHTML="<nav></nav>",i=1!==e.childNodes.length)){for(var s=n.createDocumentFragment(),d=a.length;d--;)s.createElement(a[d]);s.appendChild(e)}if(r=r.replace(/^\s\s*/,"").replace(/\s\s*$/,"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/(<([\w:]+)[^>]*?)\/>/g,t),e.innerHTML=(s=r.match(/^<(tbody|tr|td|col|colgroup|thead|tfoot)/i))?"<table>"+r+"</table>":r,s=s?e.getElementsByTagName(s[1])[0].parentNode:e,o===!1)return s.childNodes;for(var d=n.createDocumentFragment(),l=s.childNodes.length;l--;)d.appendChild(s.firstChild);return d}}(),function(){window.SPR=function(){function t(){}return t.shop=Shopify.shop,t.host="//productreviews.shopifycdn.com",t.version="v4",t.api_url=t.host+"/proxy/"+t.version,t.asset_url=t.host+"/assets/"+t.version,t.badgeEls=[],t.reviewEls=[],t.elSettings={},t.$=void 0,t.extraAjaxParams={shop:t.shop},t.registerCallbacks=function(){return this.$(document).bind("spr:badge:loaded","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onBadgeLoad:void 0),this.$(document).bind("spr:product:loaded","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onProductLoad:void 0),this.$(document).bind("spr:reviews:loaded","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onReviewsLoad:void 0),this.$(document).bind("spr:form:loaded","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onFormLoad:void 0),this.$(document).bind("spr:form:success","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onFormSuccess:void 0),this.$(document).bind("spr:form:failure","undefined"!=typeof SPRCallbacks&&null!==SPRCallbacks?SPRCallbacks.onFormFailure:void 0)},t.loadStylesheet=function(){var t,e;return e=document.createElement("link"),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",this.asset_url+"/spr.css"),e.setAttribute("media","screen"),t=document.getElementsByTagName("head")[0],t.appendChild(e)},t.initRatingHandler=function(){return t.$(document).on("mouseover mouseout","form a.spr-icon-star",function(e){var i,n,a;return i=e.currentTarget,a=t.$(i).attr("data-value"),n=t.$(i).parent(),"mouseover"===e.type?(n.find("a.spr-icon:lt("+a+")").addClass("spr-icon-star-hover"),n.find("a.spr-icon:gt("+(a-1)+")").removeClass("spr-icon-star-hover")):n.find("a.spr-icon").removeClass("spr-icon-star-hover")})},t.initDomEls=function(){return this.badgeEls=this.$(".shopify-product-reviews-badge[data-id]"),this.reviewEls=this.$("#shopify-product-reviews[data-id]"),this.$.each(this.reviewEls,function(t){return function(e,i){var n;return n=t.$(i).attr("data-id"),t.elSettings[n]={},t.elSettings[n].reviews_el="#"+(t.$(i).attr("data-reviews-prefix")?t.$(i).attr("data-reviews-prefix"):"reviews_"),t.elSettings[n].form_el="#"+(t.$(i).attr("data-form-prefix")?t.$(i).attr("data-form-prefix"):"form_")}}(this))},t.loadProducts=function(){return this.$.each(this.reviewEls,function(t){return function(e,i){var n,a,r;return a=t.$(i).attr("data-id"),n=t.$(i).attr("data-autoload"),"false"!==n?(r=t.$.extend({product_id:a,version:t.version},t.extraAjaxParams),t.$.get(t.api_url+"/reviews/product",r,t.productCallback,"jsonp")):void 0}}(this))},t.loadBadges=function(){var t,e,i,n,a;if(i=this.$.map(this.badgeEls,function(t){return function(e){return t.$(e).attr("data-id")}}(this)),i.length>0){for(e=7,a=[];(t=i.splice(0,e)).length>0;)n=this.$.extend(this.extraAjaxParams,{product_ids:t}),a.push(this.$.get(this.api_url+"/reviews/badges",n,this.badgesCallback,"jsonp"));return a}},t.pageReviews=function(t){var e,i,n;return n=this.$(t).data("product-id"),i=this.$(t).data("page"),e=this.$.extend({page:i,product_id:n},this.extraAjaxParams),this.$.get(this.api_url+"/reviews",e,this.paginateCallback,"jsonp"),!1},t.submitForm=function(t){var e;return e=this.$(t).serializeObject(),e=this.$.extend(e,this.extraAjaxParams),e=this.$.param(e),e=e.replace(/%0D%0A/g,"%0A"),this.$.ajax({url:this.api_url+"/reviews/create",type:"GET",dataType:"jsonp",data:e,success:this.formCallback,beforeSend:function(t){return function(){return t.$(".spr-button-primary").attr("disabled","disabled")}}(this),complete:function(t){return function(){return t.$(".spr-button-primary").removeAttr("disabled")}}(this)}),!1},t.reportReview=function(t){var e;return confirm("Are you sure you want to report this review as inappropriate?")&&(e=this.$.extend({id:t},this.extraAjaxParams),this.$.get(this.api_url+"/reviews/report",e,this.reportCallback,"jsonp")),!1},t.toggleReviews=function(t){var e;return e=this.$("#shopify-product-reviews[data-id='"+t+"']"),e.find(".spr-reviews").toggle()},t.toggleForm=function(t){var e;return e=this.$("#shopify-product-reviews[data-id='"+t+"']"),e.find(".spr-form").toggle()},t.setRating=function(t){var e,i,n;return e=this.$(t).parents("form"),n=this.$(t).attr("data-value"),i=this.$(t).parent(),e.find("input[name='review[rating]']").val(n),this.setStarRating(n,i)},t.setStarRating=function(t,e){return e.find("a:lt("+t+")").removeClass("spr-icon-star-empty spr-icon-star-hover"),e.find("a:gt("+(t-1)+")").removeClass("spr-icon-star-hover").addClass("spr-icon-star-empty")},t.badgesCallback=function(e){var i;return i=e.badges,t.$.map(t.badgeEls,function(e){var n;return n=t.$(e).attr("data-id"),void 0!==i[n]?(t.$(e).replaceWith(i[n]),t.$(document).trigger("spr:badge:loaded",{id:n})):void 0})},t.productCallback=function(e){var i;return i=e.remote_id.toString(),t.renderProduct(i,e.product),t.renderForm(i,e.form),t.renderReviews(i,e.reviews)},t.renderProduct=function(t,e){return this.$.map(this.reviewEls,function(i){return function(n){return t===i.$(n).attr("data-id")?(i.$(n).html(innerShiv(e,!1)),i.$(document).trigger("spr:product:loaded",{id:t})):void 0}}(this))},t.renderForm=function(t,e){var i;return i=this.$(this.elSettings[t].form_el+t),i.html(e),this.$(document).trigger("spr:form:loaded",{id:t})},t.renderReviews=function(e,i){var n;return n=t.$(t.elSettings[e].reviews_el+e),n.html(i),t.$(document).trigger("spr:reviews:loaded",{id:e})},t.formCallback=function(e){var i,n,a,r;return r=e.status,a=e.remote_id,n=e.form,i=t.$(t.elSettings[a].form_el+a),i.html(n),"failure"===r&&t.initStarRating(i),"success"===r&&t.$("#shopify-product-reviews[data-id='"+a+"'] .spr-summary-actions-newreview").hide(),t.$(document).trigger("spr:form:"+r,{id:a})},t.initStarRating=function(t){var e,i,n;return n=t.find("input[name='review[rating]']"),n&&n.val()?(i=n.val(),e=t.find(".spr-starrating"),this.setStarRating(i,e)):void 0},t.paginateCallback=function(e){var i,n;return n=e.remote_id.toString(),i=e.reviews,t.renderReviews(n,i)},t.reportCallback=function(e){var i;return i="#report_"+e.id,t.$(i).replaceWith("<span class='spr-review-reportreview'>"+t.$(i).attr("data-msg")+"</span>")},t.loadjQuery=function(e){return t.loadScript("//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js",function(){return t.$=jQuery.noConflict(!0),e()})},t.loadScript=function(t,e){var i;return i=document.createElement("script"),i.type="text/javascript",i.readyState?i.onreadystatechange=function(){return"loaded"===i.readyState||"complete"===i.readyState?(i.onreadystatechange=null,e()):void 0}:i.onload=function(){return e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},t.loadjQueryExtentions=function(t){return t.fn.serializeObject=function(){var e,i;return e={},i=this.serializeArray(),t.each(i,function(){return e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e}},t}(),function(){return SPR.loadStylesheet(),SPR.loadjQuery(function(){return SPR.$.ajaxSetup({cache:!1}),SPR.loadjQueryExtentions(SPR.$),SPR.$(document).ready(function(){return SPR.registerCallbacks(),SPR.initRatingHandler(),SPR.initDomEls(),SPR.loadProducts(),SPR.loadBadges()})})}()}.call(this);